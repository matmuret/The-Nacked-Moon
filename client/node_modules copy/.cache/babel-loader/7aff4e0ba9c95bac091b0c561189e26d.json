{"ast":null,"code":"import _regeneratorRuntime from\"/Users/filippo/Documents/DCI/myProjects/TheNakedMoon/Frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/filippo/Documents/DCI/myProjects/TheNakedMoon/Frontend/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import React,{useEffect,Fragment,useContext}from\"react\";import MyContext from\"../Context/MyContext\";import{useHistory,useParams}from\"react-router-dom\";import{useForm}from\"react-hook-form\";export default function AlbumDelete(props){var _useContext=useContext(MyContext),getAlbum=_useContext.getAlbum,setGetAlbum=_useContext.setGetAlbum;var _useContext2=useContext(MyContext),newAlbum=_useContext2.newAlbum,setNewAlbum=_useContext2.setNewAlbum;var _useForm=useForm(),register=_useForm.register,handleSubmit=_useForm.handleSubmit;// initialize the hook\nvar _useParams=useParams(),id=_useParams.id;var history=useHistory();console.log(id);/* let { handleModal } = React.useContext(ModalContext); */useEffect(function(){var getResult=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var url,res,album;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;url=\"http://localhost:5000/api/albumup/\".concat(id);_context.next=4;return fetch(url);case 4:res=_context.sent;console.log({url:url});_context.next=8;return res.json();case 8:album=_context.sent;console.log(album);setGetAlbum(album);_context.next=15;break;case 13:_context.prev=13;_context.t0=_context[\"catch\"](0);case 15:case\"end\":return _context.stop();}}},_callee,null,[[0,13]]);}));return function getResult(){return _ref.apply(this,arguments);};}();getResult();},[]);/* console.log(getAlbum); */var onSubmit=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(data){var formData,i,key,res,fromApi;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:formData=new FormData();/* console.log({ data }); */for(i=0;i<data.images.length;i++){formData.append(\"images\",data.images[i]);}/*  formData.append(\"images\", data.images); */ /*  for (const image of data.image) {\n          formData.append('image[]', image)\n       } */ /* const data={ ...images, ...newAlbum} */for(key in getAlbum){//creates a loop iterating over arrays\nformData.append(key,getAlbum[key]);}/* console.log({data}) */_context2.next=5;return fetch(\"http://localhost:5000/api/albumup/\".concat(id),{method:\"PUT\",body:formData});case 5:res=_context2.sent;_context2.next=8;return res.json();case 8:fromApi=_context2.sent;/* console.log(fromApi); */formData.delete(\"images\");setGetAlbum(fromApi.updatedAlbum);/* setNewAlbum({ ...newAlbum, images: fromApi.createdAlbum.images }); */case 11:case\"end\":return _context2.stop();}}},_callee2);}));return function onSubmit(_x){return _ref2.apply(this,arguments);};}();var DeletePhoto=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(url){var name,deleteMethod,urlToBeDeleted,res,result;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:name=url.substring(39);/* console.log(name) */deleteMethod={method:\"PUT\",headers:{\"Content-type\":\"application/json\"}};_context3.prev=2;urlToBeDeleted=\"http://localhost:5000/api/albumup/delete/\".concat(name);_context3.next=6;return fetch(urlToBeDeleted,deleteMethod);case 6:res=_context3.sent;console.log({urlToBeDeleted:urlToBeDeleted});_context3.next=10;return res.json();case 10:result=_context3.sent;console.log(result);/* history.goBack(); */_context3.next=16;break;case 14:_context3.prev=14;_context3.t0=_context3[\"catch\"](2);case 16:case\"end\":return _context3.stop();}}},_callee3,null,[[2,14]]);}));return function DeletePhoto(_x2){return _ref3.apply(this,arguments);};}();var DeleteAlbum=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(e){var deleteMethod,url,res,result;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:e.preventDefault();deleteMethod={method:\"DELETE\",// Method itself\nheaders:{\"Content-type\":\"application/json\"// Indicates the content\n}// No need to have body, because we don't send nothing to the server.\n};// Make the HTTP Delete call using fetch api\n_context4.prev=2;url=\"http://localhost:5000/api/albumup/delete/\".concat(id);_context4.next=6;return fetch(url,deleteMethod);case 6:res=_context4.sent;console.log({url:url});_context4.next=10;return res.json();case 10:result=_context4.sent;console.log(result);history.goBack();_context4.next=17;break;case 15:_context4.prev=15;_context4.t0=_context4[\"catch\"](2);case 17:case\"end\":return _context4.stop();}}},_callee4,null,[[2,15]]);}));return function DeleteAlbum(_x3){return _ref4.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(Fragment,null,/*#__PURE__*/React.createElement(\"div\",{style:{textAlign:\"center\"}},/*#__PURE__*/React.createElement(\"h1\",{className:\"VisionTitle\"},\"photos in \",/*#__PURE__*/React.createElement(\"span\",{style:{color:\"red\"}},getAlbum.albumName),\" \",/*#__PURE__*/React.createElement(\"br\",null),\" click on one photo to delete\",\" \"),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"form\",{onSubmit:handleSubmit(onSubmit)},/*#__PURE__*/React.createElement(\"button\",{type:\"submit\"},/*#__PURE__*/React.createElement(\"h3\",null,\"Add photo\")),/*#__PURE__*/React.createElement(\"input\",{name:\"images\",ref:register,required:true,type:\"file\",multiple:true})),/*#__PURE__*/React.createElement(\"button\",{type:\"\",onClick:function onClick(e){return DeleteAlbum(e);}},/*#__PURE__*/React.createElement(\"h3\",null,\"Delete Album\"))),/*#__PURE__*/React.createElement(\"div\",{className:\"soulsContainer\"},getAlbum.images&&getAlbum.images.map(function(url){console.log(getAlbum);return/*#__PURE__*/React.createElement(\"div\",{onClick:function onClick(){return DeletePhoto(url);}},\" \",/*#__PURE__*/React.createElement(\"img\",{className:\"soulsItems\",src:url,key:url}));})));}","map":{"version":3,"sources":["/Users/filippo/Documents/DCI/myProjects/TheNakedMoon/Frontend/src/Components/AlbumDelete.js"],"names":["React","useEffect","Fragment","useContext","MyContext","useHistory","useParams","useForm","AlbumDelete","props","getAlbum","setGetAlbum","newAlbum","setNewAlbum","register","handleSubmit","id","history","console","log","getResult","url","fetch","res","json","album","onSubmit","data","formData","FormData","i","images","length","append","key","method","body","fromApi","delete","updatedAlbum","DeletePhoto","name","substring","deleteMethod","headers","urlToBeDeleted","result","DeleteAlbum","e","preventDefault","goBack","textAlign","color","albumName","map"],"mappings":"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","sourcesContent":["import React, { useEffect, Fragment, useContext } from \"react\";\nimport MyContext from \"../Context/MyContext\";\nimport { useHistory, useParams } from \"react-router-dom\";\nimport { useForm } from \"react-hook-form\";\n\nexport default function AlbumDelete(props) {\n  const { getAlbum, setGetAlbum } = useContext(MyContext);\n  const { newAlbum, setNewAlbum } = useContext(MyContext);\n  const { register, handleSubmit } = useForm(); // initialize the hook\n  const { id } = useParams();\n  const history = useHistory();\n  console.log(id);\n  /* let { handleModal } = React.useContext(ModalContext); */\n\n  useEffect(() => {\n    const getResult = async () => {\n      try {\n        const url = `http://localhost:5000/api/albumup/${id}`;\n        const res = await fetch(url);\n        console.log({ url });\n        const album = await res.json();\n        console.log(album);\n        setGetAlbum(album);\n      } catch (err) {}\n    };\n    getResult();\n  }, []);\n  /* console.log(getAlbum); */\n\n  const onSubmit = async (data) => {\n    const formData = new FormData();\n    /* console.log({ data }); */\n    for (let i = 0; i < data.images.length; i++) {\n      formData.append(\"images\", data.images[i]);\n    }\n\n    /*  formData.append(\"images\", data.images); */\n    /*  for (const image of data.image) {\n          formData.append('image[]', image)\n       } */\n    /* const data={ ...images, ...newAlbum} */\n    for (let key in getAlbum) {\n      //creates a loop iterating over arrays\n      formData.append(key, getAlbum[key]);\n    }\n    /* console.log({data}) */\n    const res = await fetch(`http://localhost:5000/api/albumup/${id}`, {\n      method: \"PUT\",\n      body: formData,\n    });\n    const fromApi = await res.json();\n    /* console.log(fromApi); */\n    formData.delete(\"images\");\n    setGetAlbum(fromApi.updatedAlbum);\n    /* setNewAlbum({ ...newAlbum, images: fromApi.createdAlbum.images }); */\n  };\n  const DeletePhoto = async (url) => {\n   const name= url.substring(39)\n   /* console.log(name) */\n    const deleteMethod = {\n      method: \"PUT\",\n      headers: { \"Content-type\": \"application/json\" },\n    };\n    try {\n      const urlToBeDeleted = `http://localhost:5000/api/albumup/delete/${name}`;\n      \n      const res = await fetch(urlToBeDeleted, deleteMethod);\n      console.log({ urlToBeDeleted });\n      const result = await res.json();\n      console.log(result);\n      /* history.goBack(); */\n    } catch (err) {}\n  };\n  const DeleteAlbum = async (e) => {\n    e.preventDefault();\n    const deleteMethod = {\n      method: \"DELETE\", // Method itself\n      headers: {\n        \"Content-type\": \"application/json\", // Indicates the content\n      },\n      // No need to have body, because we don't send nothing to the server.\n    };\n    // Make the HTTP Delete call using fetch api\n    try {\n      const url = `http://localhost:5000/api/albumup/delete/${id}`;\n      const res = await fetch(url, deleteMethod);\n      console.log({ url });\n      const result = await res.json();\n      console.log(result);\n      history.goBack();\n    } catch (err) {}\n  };\n\n  return (\n    <Fragment>\n      <div style={{ textAlign: \"center\" }}>\n        <h1 className=\"VisionTitle\">\n          photos in <span style={{ color: \"red\" }}>{getAlbum.albumName}</span>{\" \"}\n          <br></br> click on one photo to delete{\" \"}\n        </h1>\n\n        <br></br>\n        <form onSubmit={handleSubmit(onSubmit)}>\n          <button type=\"submit\">\n            <h3>Add photo</h3>\n          </button>\n\n          <input name=\"images\" ref={register} required type=\"file\" multiple />\n        </form>\n        <button type=\"\" onClick={(e) => DeleteAlbum(e)}>\n          <h3>Delete Album</h3>\n        </button>\n      </div>\n      <div className=\"soulsContainer\">\n        {getAlbum.images &&\n          getAlbum.images.map((url) => {\n            console.log(getAlbum);\n            return (\n              <div onClick={() => DeletePhoto(url)}>\n                {\" \"}\n                <img className=\"soulsItems\" src={url} key={url} />\n              </div>\n            );\n          })}\n      </div>\n    </Fragment>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}